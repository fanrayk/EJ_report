# Word 報告自動生成系統 - 使用說明

## 🔧 首次使用：安裝套件

第一次使用前，請先安裝必要的套件：

```bash
pip install docxtpl openpyxl pandas pillow
```

💡 只需要安裝一次即可。

---

## 🚀 使用步驟

### 步驟 1：準備資料

創建一個資料夾（參考 `資料夾範例`），包含：

```
您的工程資料夾/
├── [工程案號].txt          # 工程資訊
├── 測量照/                 # 6張測量照片
│   ├── pt1.jpg
│   ├── pt2.jpg
│   ├── pt3.jpg
│   ├── pt4.jpg
│   ├── pt5.jpg
│   └── pt6.jpg
├── 點位圖/                 # 點位圖
│   └── [任意檔名].jpg
└── 道管截圖/               # 系統截圖
    └── [任意檔名].jpg
```

**txt 文件格式**（使用 Tab 鍵分隔）：
```
工程案號	06-113-002	申請書編號	113F04330
施工地址	北區中清路一段100號
	承攬商	庭安科技
```

### 步驟 2：修改設定

打開 `生成報告.py`，修改最上面的資料夾名稱：

```python
FOLDER_NAME = '您的工程資料夾'  # ← 改成您的資料夾名稱
```

### 步驟 3：執行程式

```bash
python 生成報告.py
```

### 步驟 4：取得報告

在 `output/` 資料夾中會看到：
```
[工程案號]_報告書.docx
```

---

## 📸 照片命名規則（重要！）

| 類型 | 命名規則 | 說明 |
|------|---------|------|
| 測量照片 | `pt1.jpg` ~ `pt6.jpg` | **必須**按照這個命名 |
| 點位圖 | 任意檔名 | 支援 .jpg 和 .png |
| 道管截圖 | 任意檔名 | 支援 .jpg 和 .png |

⚠️ **常見錯誤**：
- ❌ `photo1.jpg`、`PT1.jpg`、`pt1.png`
- ✅ `pt1.jpg`、`pt2.jpg`、...、`pt6.jpg`

---

## 🔧 常見問題

### Q: 照片沒有載入？
**A:** 檢查測量照片命名是否為 `pt1.jpg` ~ `pt6.jpg`（小寫，.jpg 副檔名）

### Q: 找不到 txt 文件？
**A:** 
1. 確認 txt 文件在資料夾根目錄
2. 確認資料夾名稱正確
3. txt 文件名稱可以是任意名稱

### Q: txt 文件格式錯誤？
**A:** 確認使用 **Tab 鍵**分隔（不是空格）。可以參考 `資料夾範例/06-113-001.txt`

### Q: 想調整照片大小？
**A:** 修改 `生成報告.py` 中的數值：
```python
# 測量照片（第 243 行附近）
InlineImage(doc, str(photo_path), width=Inches(2.3))

# 點位圖和系統截圖（第 256、268 行附近）
InlineImage(doc, str(image_files[0]), width=Inches(5))
```

### Q: 首次執行需要生成範本嗎？
**A:** 不需要！程式會自動檢查，如果範本不存在會自動生成。

---

## 💡 小技巧

### 快速準備資料
1. 複製 `資料夾範例` 資料夾
2. 改名為您的工程案號
3. 修改 txt 內容
4. 替換照片

### 批次處理多個資料夾
修改 `生成報告.py` 最後部分：

```python
# 原本的單一資料夾
FOLDER_NAME = '資料夾範例'

# 改成多個資料夾
folders = ['工程001', '工程002', '工程003']
for folder in folders:
    FOLDER_NAME = folder
    generate_report(FOLDER_NAME)
```

---

## 📁 檔案結構

```
ij_tool/
├── 使用說明.md                    # 本說明文件
├── 生成報告.py                    # 執行程式
│
├── 報告書範本_generated.docx      # 範本（自動生成）
├── 資料夾範例/                    # 範例資料
└── output/                        # 輸出資料夾
```

---

## 🎯 超簡易版流程

1. 安裝套件（首次）：`pip install docxtpl openpyxl pandas pillow`
2. 準備資料夾（參考範例）
3. 修改 `生成報告.py` 第 6 行的資料夾名稱
4. 執行：`python 生成報告.py`
5. 在 `output/` 取得報告 ✅
